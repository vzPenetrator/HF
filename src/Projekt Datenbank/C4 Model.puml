import os

def generate_plantuml():
    plantuml_code = """
    @startuml C4_Model
    !include <C4/C4_Container>
    !include <C4/C4_Component>
    !include <C4/C4_Context>

    ' Level 1: Context Diagram
    System(Student, "Sch√ºler", "Erstellt und verwaltet Fahrten")
    System(SystemDB, "MySQL Datenbank", "Speichert Fahrtdaten")
    System_Ext(User, "Benutzer", "Interagiert mit der Software")
    Rel(User, Student, "Nutzt")
    Rel(Student, SystemDB, "Liest & schreibt Daten")
    
    ' Level 2: Container Diagram
    Container(StudentApp, "Fahrten-App", "Python Flask", "Verwaltet CRUD-Funktionen")
    ContainerDb(SystemDB, "MySQL Datenbank", "MySQL", "Speichert Fahrtdaten")
    Rel(Student, StudentApp, "Verwendet")
    Rel(StudentApp, SystemDB, "Greift auf zu")
    
    ' Level 3: Component Diagram
    Component(Api, "API Layer", "Flask", "Stellt Endpunkte bereit")
    Component(DbHandler, "Datenbank Handler", "SQLAlchemy", "Kommuniziert mit der DB")
    Rel(StudentApp, Api, "Sendet Anfragen")
    Rel(Api, DbHandler, "Fragt Daten ab")
    Rel(DbHandler, SystemDB, "Speichert & holt Daten")

    @enduml
    """
    
    with open("c4_model.puml", "w", encoding="utf-8") as file:
        file.write(plantuml_code)
    print("PlantUML-Datei 'c4_model.puml' wurde erstellt!")

if __name__ == "__main__":
    generate_plantuml()